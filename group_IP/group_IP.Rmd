---
title: "group_IP"
author: "Liv Depies, Maddy Doak, Michael Kuranty"
date: "12/1/2019"
output: pdf_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(BiocGenerics)

# Importing data and renaming columns
# Then adding columns for subject and trial numbers
file_extension <- "/media/maddy/Seagate Portable Drive/git/Bio_381/group_IP/excel_data/"
data <- vector("list",5)
for (num in 1:5) {
  data[[num]] <- as_tibble(read_excel(paste(file_extension,"Data_",num,".xlsx",sep="")))
  colnames(data[[num]]) <- c("time","Ch1_mean", "Ch1_amp", "Ch1_time_max",
                             "Ch1_time_min", "Ch2_mean", "Ch2_amp", "Ch2_time_max",
                             "Ch2_time_min","Ch3_mean", "Ch3_amp", "Ch3_time_max",
                             "Ch3_time_min", "Ch4_mean", "Ch4_amp", "Ch4_time_max",
                             "Ch4_time_min")
  data[[num]] <- data[[num]] %>% mutate(subject = c(num), phrase = c(NA), spoken = c("Yes"))
  data[[num]] <- data[[num]][,c(1,18,19,20,2:17)]
}

# Removing header lines and non-trials
for (i in 2:5) {
  data[[i]] <- data[[i]][-c(1,2),]
}
data[[1]] <- data[[1]][-c(1),]
data[[3]] <- data[[3]][-c(142),]
data[[4]] <- data[[4]][-c(1,2),]
data[[4]] <- data[[4]][-c(158),]

# Adding numbering for phrases/whether they're spoken or silent
for (num in 1:5) {
  new_set <- which(grepl(paste("^","0","$",sep=""),data[[num]]$time))
  new_set <- append(new_set, length(data[[num]][[1]]))
  for (i in 1:20) {
    if (i > 10) {
      data[[num]][new_set[[i]]:new_set[[i+1]],"phrase"] <- i-10
      data[[num]][new_set[[i]]:new_set[[i+1]],"spoken"] <- "No"
    } else {
      data[[num]][new_set[[i]]:new_set[[i+1]],"phrase"] <- i
    }
  }
}

# Combining all data into one dataframe
all_data <- do.call(rbind,data)
View(all_data)
```

```{r}
plot1 <- ggplot(data[[1]],aes(x=factor(time),y=factor(Ch1_mean))) +
  geom_point()
plot1
```