ggplot(aes(x=factor(phrase),y=phrase_mean,fill=spoken)) +
geom_bar(position="dodge",stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Mean Amplitude for Phrase (mV)",
title="Ch1: Mean Amplitude by Subject/Phrase/Vocalization Condition")
png(file='ch1_mean_amp_by_conditions.png')
p1_1
dev.off()
p1_2 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch1_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE)) %>%
mutate(phrase_diff = phrase_mean - lag(phrase_mean)) %>%
ggplot(aes(x=factor(phrase),y=phrase_diff)) +
geom_bar(stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch1: Difference in Mean Amplitude Between Conditions by Phrase")
png(file='ch1_diff_mean_amp.png')
p1_2
dev.off()
# Channel 2
p2_1 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch2_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE)) %>%
ggplot(aes(x=factor(phrase),y=phrase_mean,fill=spoken)) +
geom_bar(position="dodge",stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Mean Amplitude for Phrase (mV)",
title="Ch2: Mean Amplitude by Subject/Phrase/Vocalization Condition")
png(file='ch2_mean_amp_by_conditions.png')
p2_1
dev.off()
p2_2 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch2_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE)) %>%
mutate(phrase_diff = phrase_mean - lag(phrase_mean)) %>%
ggplot(aes(x=factor(phrase),y=phrase_diff)) +
geom_bar(stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch2: Difference in Mean Amplitude Between Conditions by Phrase")
png(file='ch2_diff_mean_amp.png')
p2_2
dev.off()
# Channel 3
p3 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch3_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE))  %>%
mutate(phrase_diff = phrase_mean - lag(phrase_mean))
p3_1 <- p3 %>% ggplot(aes(x=factor(phrase),y=phrase_mean,fill=spoken)) +
geom_bar(position="dodge",stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Mean Amplitude for Phrase (mV)",
title="Ch3: Mean Amplitude by Subject/Phrase/Vocalization Condition")
png(file='ch3_mean_amp_by_conditions.png')
p3_1
dev.off()
p3_2 <- p3 %>% ggplot(aes(x=factor(phrase),y=phrase_diff)) +
geom_bar(stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch3: Difference in Mean Amplitude Between Conditions by Phrase")
png(file='ch3_diff_mean_amp.png')
p3_2
dev.off()
# Channel 3, Subject 3
p3_3 <- all_data %>%
filter(subject==3) %>%
group_by(phrase,spoken) %>%
filter(!is.na(Ch3_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE))  %>%
mutate(phrase_diff = phrase_mean - lag(phrase_mean))
p3_3_1 <- p3_3 %>% ggplot(aes(x=factor(phrase),y=phrase_mean,fill=spoken)) +
geom_bar(position="dodge",stat="identity") +
labs(x="Phrase Number",y="Mean Amplitude for Phrase (mV)",
title="Ch3/Sbj3: Mean Amplitude by Phrase/Vocalization Condition")
png(file='ch3_sbj3_mean_amp_by_conditions.png')
p3_3_1
dev.off()
p3_3_2 <- p3_3 %>% ggplot(aes(x=factor(phrase),y=phrase_diff)) +
geom_bar(stat="identity") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch3/Sbj3: Difference in Mean Amplitude Between Conditions by Phrase")
png(file='ch3_sbj3_diff_mean_amp.png')
p3_3_2
dev.off()
# Channel 4
p4_1 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch4_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
ggplot(aes(x=factor(phrase),y=phrase_mean,fill=spoken)) +
geom_bar(position="dodge",stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Mean Amplitude for Phrase (mV)",
title="Ch4: Mean Amplitude by Subject/Phrase/Vocalization Condition")
png(file='ch4_mean_amp_by_conditions.png')
p4_1
dev.off()
p4_2 <- all_data %>%
group_by(subject,phrase,spoken) %>%
filter(!is.na(Ch4_amp)) %>%
summarize(phrase_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(phrase_diff = phrase_mean - lag(phrase_mean)) %>%
ggplot(aes(x=factor(phrase),y=phrase_diff)) +
geom_bar(stat="identity") +
facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch4: Difference in Mean Amplitude Between Conditions by Phrase")
png(file='ch4_diff_mean_amp.png')
p4_2
dev.off()
library(readxl)
library(dplyr)
library(ggplot2)
library(BiocGenerics)
# Importing data and renaming columns
# Then adding columns for subject and trial numbers
file_extension <- "/media/maddy/Seagate Portable Drive/git/Bio_381/group_IP/excel_data/"
data <- vector("list",5)
for (num in 1:5) {
data[[num]] <- as_tibble(read_excel(paste(file_extension,"Data_",num,".xlsx",sep="")))
colnames(data[[num]]) <- c("time","Ch1_mean", "Ch1_amp", "Ch1_time_max",
"Ch1_time_min", "Ch2_mean", "Ch2_amp", "Ch2_time_max",
"Ch2_time_min","Ch3_mean", "Ch3_amp", "Ch3_time_max",
"Ch3_time_min", "Ch4_mean", "Ch4_amp", "Ch4_time_max",
"Ch4_time_min")
data[[num]] <- data[[num]] %>% mutate(subject = c(num), phrase = c(NA), spoken = c("Yes"))
data[[num]] <- data[[num]][,c(1,18,19,20,2:17)]
}
# Removing header lines and non-trials
for (i in 2:5) {
data[[i]] <- data[[i]][-c(1,2),]
}
data[[1]] <- data[[1]][-c(1),]
data[[1]] <- data[[1]][-c(280:282,284:286),]
data[[3]] <- data[[3]][-c(142),]
data[[3]] <- data[[3]][-c(53:55,57:59),]
data[[4]] <- data[[4]][-c(1,2),]
data[[4]] <- data[[4]][-c(158),]
data[[5]] <- data[[5]][-c(56:58,60:62),]
# Adding numbering for phrases/whether they're spoken or silent
for (num in 1:5) {
new_set <- which(grepl(paste("^","0","$",sep=""),data[[num]]$time))
new_set <- append(new_set, length(data[[num]][[1]]))
for (i in 1:20) {
if (i > 10) {
data[[num]][new_set[[i]]:new_set[[i+1]],"phrase"] <- i-10
data[[num]][new_set[[i]]:new_set[[i+1]],"spoken"] <- "No"
} else {
data[[num]][new_set[[i]]:new_set[[i+1]],"phrase"] <- i
}
}
}
# Combining all data into one dataframe
all_data <- do.call(rbind,data)
View(all_data)
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean)) %>%
ggplot(aes(x=factor(phrase))) +
geom_bar(aes(y=Ch1_diff),stat="identity") +
geom_bar(aes(y=Ch2_diff),stat="identity") +
geom_bar(aes(y=Ch3_diff),stat="identity") +
geom_bar(aes(y=Ch4_diff),stat="identity")
#facet_wrap(~ subject, ncol = 2, labeller = labeller(subject = subj_labels)) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Ch4: Difference in Mean Amplitude Between Conditions by Phrase")
p_sub1
install.packages('reshape2')
library(reshape2)
# Subject 1
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub1_m <- melt(p_sub1[,c(phrase,Ch1_diff,Ch2_diff,Ch3_diff,Ch4_diff)],id.vars=1)
View(p_sub1)
library(reshape2)
# Subject 1
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub1_m <- melt(p_sub1[,c(phrase,Ch1_diff,Ch2_diff,Ch3_diff,Ch4_diff)],id.vars=1)
library(reshape2)
# Subject 1
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub1_m <- melt(p_sub1[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
ggplot(p_sub1_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge")
library(reshape2)
# Subject 1
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub1_m <- melt(p_sub1[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj1_diff_mean_amp.png')
ggplot(p_sub1_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
# Graphs by subject
library(reshape2)
# Subject 1
p_sub1 <- all_data %>%
filter(subject == 1) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub1_m <- melt(p_sub1[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj1_diff_mean_amp.png')
ggplot(p_sub1_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
# Subject 2
p_sub2 <- all_data %>%
filter(subject == 2) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub2_m <- melt(p_sub2[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj2_diff_mean_amp.png')
ggplot(p_sub2_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 2: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
# Subject 3
p_sub3 <- all_data %>%
filter(subject == 3) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub3_m <- melt(p_sub3[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj3_diff_mean_amp.png')
ggplot(p_sub3_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 3: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
# Subject 4
p_sub4 <- all_data %>%
filter(subject == 4) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub4_m <- melt(p_sub4[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj4_diff_mean_amp.png')
ggplot(p_sub4_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 4: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
# Subject 5
p_sub5 <- all_data %>%
filter(subject == 5) %>%
group_by(phrase,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_sub5_m <- melt(p_sub5[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
png(file='sbj5_diff_mean_amp.png')
ggplot(p_sub5_m, aes(x=factor(phrase), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
png(file='sbj5_diff_mean_amp_ALT.png')
ggplot(p_sub5_m, aes(x=factor(phrase), y=value)) +
geom_bar(stat="identity",position="dodge") +
facet_wrap(~variable, ncol = 2) +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
dev.off()
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_phrs1_m <- melt(p_phrs1[,c('phrase','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
summarize(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE)) %>%
mutate(Ch1_diff = Ch1_mean - lag(Ch1_mean),
Ch2_diff = Ch2_mean - lag(Ch2_mean),
Ch3_diff = Ch3_mean - lag(Ch3_mean),
Ch4_diff = Ch4_mean - lag(Ch4_mean))
p_phrs1_m <- melt(p_phrs1[,c('subject','Ch1_diff','Ch2_diff','Ch3_diff','Ch4_diff')],id.vars=1)
ggplot(p_sub5_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
View(p_phrs1)
ggplot(p_phrs1_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Phrase Number",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Subject 1: Diff in Mean Amplitude Between Conditions by Phrase",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
png(file='phrs1_diff_mean_amp.png')
ggplot(p_phrs1_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
dev.off()
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
mutate(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE))
p_phrs1_m <- melt(p_phrs1[,c('subject','Ch1_mean','Ch2_mean','Ch3_mean','Ch4_mean')],id.vars=1)
ggplot(p_phrs1_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncols=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(subject), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncol=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(spoken), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncol=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
mutate(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE))
p_phrs1_m <- melt(p_phrs1[,c('spoken','Ch1_mean','Ch2_mean','Ch3_mean','Ch4_mean')],id.vars=1)
ggplot(p_phrs1_m, aes(x=factor(spoken), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncol=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
mutate(Ch1_mean = mean(as.numeric(Ch1_amp),na.rm=TRUE),
Ch2_mean = mean(as.numeric(Ch2_amp),na.rm=TRUE),
Ch3_mean = mean(as.numeric(Ch3_amp),na.rm=TRUE),
Ch4_mean = mean(as.numeric(Ch4_amp),na.rm=TRUE))
p_phrs1_m <- melt(p_phrs1[,c('subject','spoken','Ch1_mean','Ch2_mean','Ch3_mean','Ch4_mean')],id.vars=c(1,2))
ggplot(p_phrs1_m, aes(x=factor(spoken), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncol=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Diff in Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(spoken), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject,ncol=2) +
labs(x="Subject",y="Difference in Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(spoken), y=value)) +
geom_bar(aes(fill=variable),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Vocalization",y="Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(variable), y=value)) +
geom_bar(aes(fill=spoken),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Vocalization",y="Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(variable), y=value)) +
geom_bar(aes(fill=spoken),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Vocalization",y="Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Muscle")
# Phrase 1
p_phrs1 <- all_data %>%
filter(phrase==1) %>%
group_by(subject,spoken) %>%
mutate(M1 = mean(as.numeric(Ch1_amp),na.rm=TRUE),
M2 = mean(as.numeric(Ch2_amp),na.rm=TRUE),
M3 = mean(as.numeric(Ch3_amp),na.rm=TRUE),
M4 = mean(as.numeric(Ch4_amp),na.rm=TRUE))
p_phrs1_m <- melt(p_phrs1[,c('subject','spoken','M1','M2','M3','M4')],id.vars=c(1,2))
ggplot(p_phrs1_m, aes(x=factor(variable), y=value)) +
geom_bar(aes(fill=spoken),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Vocalization",y="Mean Amplitude (Spoken-Silent)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Muscle")
ggplot(p_phrs1_m, aes(x=factor(variable), y=value)) +
geom_bar(aes(fill=spoken),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Muscle",y="Mean Amplitude (mV)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Vocalized")
png(file='phrs1_mean_amp.png')
ggplot(p_phrs1_m, aes(x=factor(variable), y=value)) +
geom_bar(aes(fill=spoken),stat="identity",position="dodge") +
facet_wrap(~subject, ncol=2, labeller = labeller(subject = subj_labels)) +
labs(x="Muscle",y="Mean Amplitude (mV)",
title="Phrase 1: Mean Amplitude Between Conditions by Subject",
fill="Vocalized")
dev.off()
